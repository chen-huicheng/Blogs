## 消息队列

### 解耦

### 异步

健康管理预约事件处理，发一个异步的消息，收到消息后再做处理

缺点：可用性降低，

### 削峰、限流

秒杀场景，所有的请求可以写消息队列而不作实际处理，然后让服务以能够处理的最大 QPS 慢慢处理。

## RocketMQ

参考：https://www.cnblogs.com/qdhxhz/p/11094624.html

一、消息队列基础概念

1.   **producer**：生产者，通过指定topic来发送消息。
2.   **producer group**：生成组，发送同一类消息的生产者。
3.   **consumer**：消费者
4.   **consumer group**：消费组，多个消费者实例。
5.   **topic**：业务层面消息的逻辑队列，用于区分不同业务场景的消息;
6.   **Queue**：一个 topic 包含多个 queue，主要用于负载均衡
7.   **message**：
8.   **broker**：负责接受并存储消息，同时提供Push/Pull接口来将消息发送给Consumer。Consumer可选择从Master或者Slave读取数据。多个主/从组成Broker集群，集群内的Master节点之间不做数据交互。Broker同时提供消息查询的功能，可以通过MessageID和MessageKey来查询消息。Borker会将自己的Topic配置信息实时同步到NameServer。



### Broker 、Topic 和 message Queue 的关系

![f3597e95-4f74-4212-a987-729ef1da2d29](https://raw.githubusercontent.com/chen-huicheng/ImageHub/main/typora_img/202307251046293.png)

### NameServer和broker

![img](https://raw.githubusercontent.com/chen-huicheng/ImageHub/main/typora_img/202307251101978.png)

### broker

每个 broker 

## kafka